<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run CancerGov Scrape and Store — cg_run • skyscraper</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run CancerGov Scrape and Store — cg_run" />
<meta property="og:description" content="Run the full sequence that scrapes, parses, and stores the NCI Drug Dictionary found at CancerGov.org and any correlates to the NCI Thesaurus in a Postgres Database." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">skyscraper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/meerapatelmd/skyscraper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run CancerGov Scrape and Store</h1>
    <small class="dont-index">Source: <a href='https://github.com/meerapatelmd/skyscraper/blob/master/R/cg.R'><code>R/cg.R</code></a></small>
    <div class="hidden name"><code>cg_run.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run the full sequence that scrapes, parses, and stores the NCI Drug Dictionary found at CancerGov.org and any correlates to the NCI Thesaurus in a Postgres Database.</p>
    </div>

    <pre class="usage"><span class='fu'>cg_run</span><span class='op'>(</span>
  <span class='va'>conn</span>,
  <span class='va'>conn_fun</span>,
  steps <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"log_drug_count"</span>, <span class='st'>"get_dictionary_and_links"</span>, <span class='st'>"process_drug_link_synonym"</span>,
    <span class='st'>"process_drug_link_url"</span>, <span class='st'>"process_drug_link_ncit"</span>, <span class='st'>"get_ncit_synonym"</span>,
    <span class='st'>"update_cancergov_drugs"</span><span class='op'>)</span>,
  max_page <span class='op'>=</span> <span class='fl'>50</span>,
  sleep_time <span class='op'>=</span> <span class='fl'>5</span>,
  encoding <span class='op'>=</span> <span class='st'>""</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RECOVER"</span>, <span class='st'>"NOERROR"</span>, <span class='st'>"NOBLANKS"</span><span class='op'>)</span>,
  expiration_days <span class='op'>=</span> <span class='fl'>30</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  render_sql <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>conn</th>
      <td><p>Postgres connection object.</p></td>
    </tr>
    <tr>
      <th>conn_fun</th>
      <td><p>(optional) An expr as a string that can be parsed and evaluated into a connection object. If present, it is used in lieu of the <code>conn</code> argument and disconnects the connection on exit.</p></td>
    </tr>
    <tr>
      <th>steps</th>
      <td><p>The sequence of steps, labeled by the internal function that is called. A step can be skipped if it is removed from the list, but the order in which they are called does not change. Adding any erroneous values to this list does not have an effect. Default: c("log_drug_count", "get_dictionary_and_links", "process_drug_link_synonym", "process_drug_link_url", "process_drug_link_ncit", "get_ncit_synonym", "update_cancergov_drugs").</p></td>
    </tr>
    <tr>
      <th>max_page</th>
      <td><p>maximum page number to iterate the scrape over in the "https://www.cancer.gov/publications/dictionaries/cancer-drug?expand=ALL&amp;page=" path, Default: 50</p></td>
    </tr>
    <tr>
      <th>sleep_time</th>
      <td><p>Time in seconds for the system to sleep before each scrape with <code><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></code>.</p></td>
    </tr>
    <tr>
      <th>encoding</th>
      <td><p>Specify a default encoding for the document. Unless
otherwise specified XML documents are assumed to be in UTF-8 or
UTF-16. If the document is not UTF-8/16, and lacks an explicit
encoding directive, this allows you to supply a default.</p></td>
    </tr>
    <tr>
      <th>options</th>
      <td><p>Set parsing options for the libxml2 parser. Zero or more of</p><dl>
  <dt>RECOVER</dt><dd><p>recover on errors</p></dd>
  <dt>NOENT</dt><dd><p>substitute entities</p></dd>
  <dt>DTDLOAD</dt><dd><p>load the external subset</p></dd>
  <dt>DTDATTR</dt><dd><p>default DTD attributes</p></dd>
  <dt>DTDVALID</dt><dd><p>validate with the DTD</p></dd>
  <dt>NOERROR</dt><dd><p>suppress error reports</p></dd>
  <dt>NOWARNING</dt><dd><p>suppress warning reports</p></dd>
  <dt>PEDANTIC</dt><dd><p>pedantic error reporting</p></dd>
  <dt>NOBLANKS</dt><dd><p>remove blank nodes</p></dd>
  <dt>SAX1</dt><dd><p>use the SAX1 interface internally</p></dd>
  <dt>XINCLUDE</dt><dd><p>Implement XInclude substitition</p></dd>
  <dt>NONET</dt><dd><p>Forbid network access</p></dd>
  <dt>NODICT</dt><dd><p>Do not reuse the context dictionary</p></dd>
  <dt>NSCLEAN</dt><dd><p>remove redundant namespaces declarations</p></dd>
  <dt>NOCDATA</dt><dd><p>merge CDATA as text nodes</p></dd>
  <dt>NOXINCNODE</dt><dd><p>do not generate XINCLUDE START/END nodes</p></dd>
  <dt>COMPACT</dt><dd><p>compact small text nodes; no modification of the tree allowed afterwards (will possibly crash if you try to modify the tree)</p></dd>
  <dt>OLD10</dt><dd><p>parse using XML-1.0 before update 5</p></dd>
  <dt>NOBASEFIX</dt><dd><p>do not fixup XINCLUDE xml:base uris</p></dd>
  <dt>HUGE</dt><dd><p>relax any hardcoded limit from the parser</p></dd>
  <dt>OLDSAX</dt><dd><p>parse using SAX2 interface before 2.7.0</p></dd>
  <dt>IGNORE_ENC</dt><dd><p>ignore internal document encoding hint</p></dd>
  <dt>BIG_LINES</dt><dd><p>Store big lines numbers in text PSVI field</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>When reading from a slow connection, this prints some
output on every iteration so you know its working.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="web-source-types"><a class="anchor" href="#web-source-types"></a>Web Source Types</h2>

    

<p>The NCI Drug Dictionary has 2 data sources that run in parallel. The first source is the Drug Dictionary itself at <a href='https://www.cancer.gov/publications/dictionaries/cancer-drug'>https://www.cancer.gov/publications/dictionaries/cancer-drug</a>. The other source are the individual drug pages, called Drug Detail Links in skyscraper, that contain tables of synonyms, including investigational names.</p>
    <h2 class="hasAnchor" id="drug-dictionary"><a class="anchor" href="#drug-dictionary"></a>Drug Dictionary</h2>

    

<p>The listed drug names and their definitions are scraped from the Drug Dictionary HTML and updated to a Drug Dictionary Table in a <code>cancergov</code> schema.</p>
    <h2 class="hasAnchor" id="drug-detail-links"><a class="anchor" href="#drug-detail-links"></a>Drug Detail Links</h2>

    

<p>The links to Drug Pages are scraped from the Data Dictionary URL over the maximum page number and are saved to a Drug Link Table in the <code>cancergov</code> schema. The URLs in the Drug Link Table are then scraped for any HTML Tables of synonyms and the results are written to a Drug Link Synonym Table. The links to active clinical trials and NCIt mappings are also derived and stored in their respective tables.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Meera Patel, MD.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


